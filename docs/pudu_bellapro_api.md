# Pudu 貝拉 PRO 開放 API 文件

> **文件版本**: v1.0  
> **整理日期**: 2024/12  
> **適用機型**: 貝拉 PRO (Bella PRO)  
> **用途**: SWAT Team 站點間 AMR 整合評估

---

## 目錄

1. [回調通知 (Callback Notifications)](#1-回調通知-callback-notifications)
2. [通用接口 (General API)](#2-通用接口-general-api)
3. [機器人任務 (Robot Tasks)](#3-機器人任務-robot-tasks)
4. [控制指令 (Control Commands)](#4-控制指令-control-commands)
5. [統計數據 (Statistics)](#5-統計數據-statistics)
6. [SWAT Team 整合重點](#6-swat-team-整合重點)

---

## 1. 回調通知 (Callback Notifications)

回調通知為 Pudu 雲平台主動推送至第三方系統的事件通知。

### 1.1 機器狀態與綁定

| 回調名稱 | API Endpoint | 說明 |
|---------|--------------|------|
| 機器異常故障回調 | `robotErrorWarning` | 10 分鐘延遲通知 |
| 異常實時通知 | `robotErrorNotice` | 即時故障通知 |
| 機器綁定門店通知 | `robotBinding` | 機器與門店綁定事件 |
| 機器解綁門店通知 | `robotUnBinding` | 機器與門店解綁事件 |
| 機器激活通知 | `robotActivate` | 機器首次激活 |
| 機器在線/離線狀態變更 | `robotStatus` | 連線狀態變更 |
| 急停恢復通知 | `robotEmergencyRecover` | 急停按鈕恢復 |
| 機器工作狀態通知 | `notifyRobotStatus` | 工作狀態變更 |

### 1.2 地圖與位置回調

| 回調名稱 | API Endpoint | 說明 |
|---------|--------------|------|
| 地圖元素變更通知 | `mapElementChange` | 地圖信息（元素點）上傳/變更/刪除 |
| 機器位置上報 | `notifyRobotPose` | ⭐ 即時位置回報 |
| 機器移動狀態通知 | `notifyRobotMoveState` | 移動/停止狀態變更 |

### 1.3 任務執行

| 回調名稱 | API Endpoint | 說明 |
|---------|--------------|------|
| 呼叫狀態通知 | `notifyCustomCall` | ⭐ 呼叫任務狀態回調 |
| 配送任務通知 | `notifyDeliveryTask` | 配送任務狀態回調 |

### 1.4 硬件控制與感知

| 回調名稱 | API Endpoint | 說明 |
|---------|--------------|------|
| 機器電量通知 | `notifyRobotPower` | 電量變化通知 |

---

## 2. 通用接口 (General API)

### 2.1 門店管理

| API 名稱 | 說明 |
|---------|------|
| 獲取門店列表 | 查詢帳號下所有門店 |
| 門店綁定/解綁 | 機器與門店的綁定關係管理 |
| 門店機器列表 | 查詢特定門店下的機器清單 |

### 2.2 地圖信息

| API 名稱 | 說明 |
|---------|------|
| 門店下地圖列表 | 查詢門店內所有地圖 |
| 機器可用地圖列表 | 查詢機器可使用的地圖 |
| 機器當前使用地圖 | 獲取機器正在使用的地圖 |
| 獲取地圖詳情 V2 | 地圖詳細資訊 |
| 繪製解析後的地圖 V2 | 取得渲染後的地圖圖像 |
| 獲取機器實時地圖位置 | ⭐ 即時位置座標 |
| 獲取機器當前使用地圖的點位 | ⭐ 地圖上定義的所有點位 |

### 2.3 機器人信息

| API 名稱 | 版本 | 說明 |
|---------|-----|------|
| 獲取指定機器人狀態 | V1 | 單一機器狀態查詢 |
| 獲取指定機器人狀態 | V2 | 單一機器狀態查詢（擴展） |
| 獲取組中機器人狀態 | V1 | 批量查詢機器組狀態 |
| 獲取組中機器人狀態 | V2 | 批量查詢機器組狀態（擴展） |

### 2.4 機器人組

| API 名稱 | 說明 |
|---------|------|
| 獲取綁定的機器人組 | 查詢帳號下的機器組 |
| 獲取機器人組中的機器人 | 查詢特定組內的機器清單 |

---

## 3. 機器人任務 (Robot Tasks)

### 3.1 呼叫機器人 ⭐

> **SWAT Team 核心功能**：用於呼叫機器人到指定站點

| API 名稱 | 說明 |
|---------|------|
| 發起呼叫任務 | ⭐ 呼叫機器人到指定點位 |
| 取消呼叫任務 | 取消進行中的呼叫 |
| 完成呼叫任務 | 標記呼叫任務完成 |
| 發送自定義展示內容 | 發送螢幕顯示內容 |
| 獲取呼叫列表 | 查詢呼叫任務記錄 |

### 3.2 配送任務

| API 名稱 | 說明 |
|---------|------|
| 配送任務 | 建立配送任務（多點配送） |
| 配送指令 | 配送流程控制指令 |

---

## 4. 控制指令 (Control Commands)

### 4.1 地圖與位置

| API 名稱 | 說明 |
|---------|------|
| 通知機器上報位置 | ⭐ 主動請求機器回報當前位置 |

---

## 5. 統計數據 (Statistics)

### 5.1 概覽數據

| API 名稱 | 說明 |
|---------|------|
| 機器概覽 | 單機運行總覽 |
| 機器運行概覽 | 機器運行統計摘要 |
| 門店概覽 | 門店營運總覽 |
| 機器運行分析-折線柱狀圖數據 | 圖表數據 |
| 門店分析-折線柱狀圖數據 | 圖表數據 |
| 機器運行分析-列表分頁查詢 | 列表數據 |
| 門店分析-列表分頁查詢 | 列表數據 |

### 5.2 模式統計數據

| 模式 | 圖表 API | 列表 API |
|-----|---------|---------|
| 廣告 | 廣告-總數折線柱狀圖數據 | 廣告-列表分頁查詢 |
| 呼叫 | 呼叫-總數折線柱狀圖數據 | 呼叫-列表分頁查詢 |
| 巡航 | 巡航-總數折線柱狀圖數據 | 巡航-列表分頁查詢 |
| 配送 | 配送-總數折線柱狀圖數據 | 配送-列表分頁查詢 |
| 領位 | 領位-總數折線柱狀圖數據 | 領位-列表分頁查詢 |
| 回盤 | 回盤-總數折線柱狀圖數據 | 回盤-列表分頁查詢 |

### 5.3 任務明細數據

| API 名稱 | 說明 |
|---------|------|
| 呼叫-目的地執行明細 | 呼叫任務詳細記錄 |
| 配送-目的地執行明細 | 配送任務詳細記錄 |
| 領位-目的地執行明細 | 領位任務詳細記錄 |
| 回盤-目的地執行明細 | 回盤任務詳細記錄 |

### 5.4 日誌數據

| API 名稱 | 說明 |
|---------|------|
| 開機自檢-查詢 List | 開機自檢日誌 |
| 充電記錄-查詢 List | ⭐ 充電對接記錄 |
| 故障事件-查詢 List | 故障事件日誌 |

---

## 6. SWAT Team 整合重點

### 6.1 核心整合 API

針對「大廳站 ↔ 樓層站」AMR 應用，以下 API 為整合關鍵：

| 功能需求 | 推薦 API | 類型 |
|---------|---------|------|
| **呼叫到站點** | 發起呼叫任務 | 主動調用 |
| **確認到達** | `notifyCustomCall` | 回調通知 |
| **取得即時位置** | `notifyRobotPose` | 回調通知 |
| **主動查詢位置** | 通知機器上報位置 | 主動調用 |
| **取得地圖點位** | 獲取機器當前使用地圖的點位 | 主動調用 |
| **充電對接記錄** | 充電記錄-查詢 List | 主動調用 |
| **電量監控** | `notifyRobotPower` | 回調通知 |

### 6.2 定位精準度相關

| 需求 | 可用資源 | 備註 |
|-----|---------|------|
| 到達位置精度 | `notifyRobotPose` 回調 | 需確認回傳座標精度 |
| 歷史軌跡分析 | 任務明細數據 | 可分析到達點散布 |
| 充電對接成功率 | 充電記錄-查詢 List | 間接反映對接精度 |

### 6.3 待確認事項

1. **`notifyRobotPose` 回調頻率與座標精度**
   - 座標單位（mm / cm / m）
   - 更新頻率（Hz）
   - 是否包含航向角

2. **「發起呼叫任務」參數細節**
   - 目標點位指定方式（點位名稱 / 座標）
   - 到達判定距離閾值
   - 是否有到達精度回報欄位

3. **充電座對接 API**
   - 是否有專用對接指令
   - 對接狀態回調

---

## 附錄：API 分類索引

### 按功能分類

```
├── 回調通知 (Callback)
│   ├── 機器狀態與綁定 (8)
│   ├── 地圖與位置回調 (3)
│   ├── 任務執行 (2)
│   └── 硬件控制與感知 (1)
│
├── 通用接口 (General)
│   ├── 門店管理 (3)
│   ├── 地圖信息 (7)
│   ├── 機器人信息 (4)
│   └── 機器人組 (2)
│
├── 機器人任務 (Tasks)
│   ├── 呼叫機器人 (5)
│   └── 配送任務 (2)
│
├── 控制指令 (Control)
│   └── 地圖與位置 (1)
│
└── 統計數據 (Statistics)
    ├── 概覽數據 (7)
    ├── 模式統計數據 (12)
    ├── 任務明細數據 (4)
    └── 日誌數據 (3)
```

### SWAT Team 優先級

| 優先級 | API | 用途 |
|-------|-----|------|
| P0 | 發起呼叫任務 | 核心調度功能 |
| P0 | notifyCustomCall | 任務狀態追蹤 |
| P0 | notifyRobotPose | 位置監控 |
| P1 | 獲取機器當前使用地圖的點位 | 站點管理 |
| P1 | notifyRobotPower | 電量管理 |
| P1 | 充電記錄-查詢 List | 充電管理 |
| P2 | 機器運行概覽 | 營運報表 |
| P2 | 任務明細數據 | 歷史分析 |

---

> **文件維護**: Ray @ SWAT Team  
> **下次更新**: 待取得 API 詳細參數規格後補充
